<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>고객사 관리 • 보안 콘솔</title>

  <!-- 공통 사이드바/타이포 -->
  <link rel="stylesheet" th:href="@{/css/nav.css}" href="/css/nav.css">
  <!-- 페이지 전용 -->
  <link rel="stylesheet" th:href="@{/css/customers.css}" href="/css/customers.css">
</head>
<body>
  <div class="layout">
    <!-- 활성 메뉴 = customers -->
    <div th:replace="~{fragments/nav :: sidebar(active=${'customers'}, mode=${'admin'})}"></div>

    <main class="content">
      <!-- 헤더 -->
      <header class="page-head">
        <div>
          <h1 class="h1">고객사 관리</h1>
          <div class="muted">고객사 등록/수정, 목록 조회, 상세(유입/삭제/정산) 보기</div>
        </div>
      </header>

      <!-- 상단 툴바 -->
      <section class="toolbar">
        <div class="left">
          <input id="q" class="searchbox" placeholder="코드/회사명 검색" autocomplete="off">
          <button id="btnSearch" class="btn">검색</button>
          <button id="btnRefresh" class="btn">새로고침</button>
        </div>
        <div class="right">
          <button id="btnNew" class="btn primary">+ 새 고객사</button>
        </div>
      </section>

      <!-- 목록 카드 -->
      <section class="card">
        <div class="table-wrap">
          <table class="table" id="custTable" style="width:100%">
            <colgroup>
              <col style="width:100px"><!-- 코드 -->
              <col style="width:240px"><!-- 회사명 -->
              <col style="width:110px"><!-- CPI -->
              <col style="width:110px"><!-- RS -->
              <col style="width:160px"><!-- 작업 -->
            </colgroup>
            <thead>
              <tr>
                <th>코드</th>
                <th>회사명</th>
                <th class="num">CPI%</th>
                <th class="num">RS%</th>
                <th>작업</th>
              </tr>
            </thead>
            <tbody><!-- JS 렌더링 --></tbody>
          </table>
        </div>
        <div id="listInfo" class="caption">-</div>
      </section>

      <p class="muted foot-note">
        행을 클릭하면 <span class="badge">상세</span> 페이지로 이동하여 월별 유입/삭제/정산 금액을 볼 수 있어요.
      </p>
    </main>
  </div>

  <!-- 등록/수정 모달 -->
  <div class="modal-backdrop" id="custModal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal">
      <header>
        <h3 id="modalTitle">고객사 등록</h3>
        <button class="btn ghost" id="btnCloseModal" aria-label="닫기">✖</button>
      </header>

      <div class="content">
        <input type="hidden" id="custId">
        <div class="form-grid" id="custForm">
          <label for="code">회사 코드</label>
          <input id="code" placeholder="예: mg (소문자/숫자/-_)" autocomplete="off">

          <label for="name">회사명</label>
          <input id="name" placeholder="예: MG 주식회사">

          <label for="cpiRate">CPI %</label>
          <input id="cpiRate" type="number" step="0.01" min="0" max="100" value="0">

          <label for="rsRate">RS %</label>
          <input id="rsRate" type="number" step="0.01" min="0" max="100" value="0">

          <label for="note">비고</label>
          <textarea id="note" rows="3" placeholder="메모/특이사항"></textarea>
        </div>
        <div id="formErr" class="error"></div>
      </div>

      <footer>
        <div class="actions">
          <button class="btn" id="btnReset">초기화</button>
          <button class="btn primary" id="btnSave">저장</button>
        </div>
      </footer>
    </div>
  </div>

  <!-- JS -->
  <script th:src="@{/js/auth_ui.js}" src="/js/auth_ui.js" defer></script>
  <script th:src="@{/js/customers.js}" src="/js/customers.js" defer></script>
  <script th:src="@{/js/nav.js}" src="/js/nav.js" defer></script>
</body>
</html>
